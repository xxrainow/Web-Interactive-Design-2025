<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ë²„ìŠ¤íƒˆê¹Œ? ê±¸ì–´ê°ˆê¹Œ?</title>
    <style>
      :root {
        /* í•˜ëŠ˜ìƒ‰ ê³„ì—´, ì €ì±„ë„(ì¨í•œ ìƒ‰/ê·¸ë¼ë°ì´ì…˜ ë²„íŠ¼ ê¸ˆì§€) */
        --bg: #f5fbff;
        --bg-soft: #e9f5ff;
        --card: #ffffff;
        --border: #dbe7f3;
        --text: #1f2e3a;
        --muted: #6e8090;
        --ink: #3f5d73;
        --ok: #2f7d55;
        --warn: #7d6a31;
        --pill: #eef6ff;
        --radius: 16px;
        --shadow: 0 10px 24px rgba(31, 42, 55, 0.06);
      }
      * {
        box-sizing: border-box;
      }
      html,
      body {
        height: 100%;
      }
      body {
        margin: 0;
        background: radial-gradient(
            900px 260px at 100% -40%,
            var(--bg-soft),
            transparent 60%
          ),
          radial-gradient(
            700px 220px at -10% 110%,
            var(--bg-soft),
            transparent 60%
          ),
          var(--bg);
        color: var(--text);
        font-family: system-ui, -apple-system, Segoe UI, Roboto,
          'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
      }

      .wrap {
        max-width: 920px;
        margin: 0 auto;
        padding: 28px 16px 64px;
      }

      header {
        display: flex;
        align-items: flex-end;
        justify-content: space-between;
        gap: 12px;
        flex-wrap: wrap;
        margin-bottom: 16px;
      }
      .title {
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 800;
        letter-spacing: -0.02em;
      }
      h1 {
        font-size: clamp(20px, 3.5vw, 28px);
        margin: 0;
      }
      .subtitle {
        color: var(--muted);
        font-size: 14px;
      }

      /* ê·€ì—¬ìš´ ë²„ìŠ¤ ì•„ì´ì½˜ (í•˜ëŠ˜ìƒ‰ í†¤) */
      .bus {
        width: 32px;
        height: 32px;
        color: var(--ink);
      }

      .card {
        background: var(--card);
        border: 1px solid var(--border);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
      }
      .inner {
        padding: 18px;
      }

      .grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 16px;
      }

      h2 {
        margin: 0 0 12px 0;
        font-size: 18px;
      }
      label {
        display: block;
        font-size: 13px;
        color: var(--muted);
        margin: 10px 0 6px;
      }
      input {
        width: 100%;
        padding: 12px 14px;
        border-radius: 12px;
        border: 1px solid var(--border);
        background: #f9fcff;
        color: var(--text);
        outline: none;
        font-size: 16px;
      }
      input:focus {
        border-color: #cfe2f2;
        box-shadow: 0 0 0 3px rgba(63, 93, 115, 0.12);
      }

      .form {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
      }
      @media (max-width: 720px) {
        .form {
          grid-template-columns: 1fr;
        }
      }

      .row {
        display: flex;
        gap: 8px;
        align-items: center;
        flex-wrap: wrap;
        margin-top: 10px;
      }
      .btn {
        appearance: none;
        border: 1px solid #cfe2f2;
        background: #eef6fd;
        color: #294356;
        font-weight: 700;
        padding: 10px 14px;
        border-radius: 12px;
        cursor: pointer;
      }
      .btn:hover {
        background: #e9f2fb;
      }
      .btn:active {
        background: #e3ecf6;
      }
      .btn.ghost {
        background: #fff;
        color: #324f63;
      }
      .link {
        font-size: 12px;
        color: #4b6a83;
        text-decoration: underline;
        cursor: pointer;
      }

      .result {
        margin-top: 12px;
        padding: 14px;
        border-radius: 12px;
        background: #f0f7fe;
        border: 1px dashed #cfe2f2;
      }
      .result h3 {
        margin: 0 0 6px 0;
        font-size: 16px;
      }
      .kv {
        display: grid;
        grid-template-columns: 140px 1fr;
        gap: 8px;
        font-size: 14px;
      }
      .ok {
        color: var(--ok);
        font-weight: 800;
      }
      .warn {
        color: var(--warn);
        font-weight: 800;
      }
      .muted {
        color: var(--muted);
      }
      .pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: var(--pill);
        border: 1px solid var(--border);
        padding: 6px 10px;
        border-radius: 999px;
        font-size: 12px;
      }
    </style>
  </head>
  <body>
    <div class="wrap">
      <header>
        <div class="title">
          <svg
            class="bus"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
            aria-hidden="true"
          >
            <rect x="4" y="5" width="16" height="10" rx="3" />
            <path d="M6 15v2M18 15v2M6 10h4M14 10h4" />
            <circle cx="7" cy="19" r="1" />
            <circle cx="17" cy="19" r="1" />
          </svg>
          <h1>ë²„ìŠ¤íƒˆê¹Œ? ê±¸ì–´ê°ˆê¹Œ?</h1>
        </div>
        <div class="subtitle">
          ë²„ìŠ¤ ë„ì°©ì˜ˆì •ì‹œê°„ê³¼ ë„ë³´ ë„ì°©ì˜ˆì •ì‹œê°„ì„ ë¹„êµí•˜ì—¬ ë” ë¹ ë¥¸ ìª½ì„
          ì¶”ì²œí•´ì¤ë‹ˆë‹¤
        </div>
      </header>

      <main class="grid">
        <section class="card">
          <div class="inner">
            <h2>ì…ë ¥</h2>
            <div class="form">
              <div>
                <label for="walkAll">ëª©ì ì§€ê¹Œì§€ ë„ë³´ ì‹œê°„ (ë¶„)</label>
                <input
                  id="walkAll"
                  type="number"
                  min="1"
                  placeholder="ì˜ˆ: 22"
                />
              </div>
              <div>
                <label for="toStop">ì •ë¥˜ì¥ê¹Œì§€ ê±·ëŠ” ì‹œê°„ (ë¶„)</label>
                <input id="toStop" type="number" min="0" placeholder="ì˜ˆ: 5" />
              </div>
              <div>
                <label for="headway">ë²„ìŠ¤ ë°°ì°¨ ê°„ê²© (ë¶„)</label>
                <input
                  id="headway"
                  type="number"
                  min="1"
                  step="0.1"
                  placeholder="ì˜ˆ: 10"
                />
              </div>
              <div>
                <label for="ride">ë²„ìŠ¤ íƒ‘ìŠ¹ ì†Œìš” (ë¶„)</label>
                <input
                  id="ride"
                  type="number"
                  min="1"
                  step="0.1"
                  placeholder="ì˜ˆ: 12"
                />
              </div>
              <div>
                <label for="nextBus">ë‹¤ìŒ ë²„ìŠ¤ê¹Œì§€ ë‚¨ì€ ì‹œê°„ (ë¶„, ì„ íƒ)</label>
                <input
                  id="nextBus"
                  type="number"
                  min="0"
                  step="0.1"
                  placeholder="ì˜ˆ: 3 (ëª¨ë¥´ë©´ ë¹„ì›Œë‘ê¸°)"
                />
              </div>
              <div>
                <label>&nbsp;</label>
                <div class="row">
                  <button id="calc" class="btn">ê³„ì‚°í•˜ê¸°</button>
                  <button id="reset" class="btn ghost">ì´ˆê¸°í™”</button>
                  <span id="fill" class="link">ì˜ˆì‹œ ì±„ìš°ê¸°</span>
                </div>
              </div>
            </div>

            <div id="out" class="result" aria-live="polite">
              <h3>ê²°ê³¼</h3>
              <div class="muted" style="font-size: 13px">
                ê°’ì„ ì…ë ¥í•˜ê³  <b>ê³„ì‚°í•˜ê¸°</b>ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <script>
      const $ = (s) => document.querySelector(s);

      function waitTime(toStop, headway, nextBus) {
        if (Number.isFinite(nextBus)) {
          if (nextBus >= toStop) return nextBus - toStop; // ë°”ë¡œ ì˜¤ëŠ” ë²„ìŠ¤ íƒ‘ìŠ¹
          const lag = (toStop - nextBus) % headway; // ë†“ì¹œ ì‹œê°„ ì°¨ì´
          return lag === 0 ? 0 : headway - lag; // ë‹¤ìŒ íšŒì°¨ê¹Œì§€ ëŒ€ê¸°
        }
        return headway / 2; // ì •ë³´ ì—†ì„ ë•Œ í‰ê·  ëŒ€ê¸°ì‹œê°„ ê°€ì •
      }

      function fmt(x) {
        return Number.isFinite(x) ? x.toFixed(1).replace(/\.0$/, '') : '-';
      }

      function calc() {
        const walkAll = +$('#walkAll').value;
        const toStop = +$('#toStop').value;
        const headway = +$('#headway').value;
        const ride = +$('#ride').value;
        const nextVal = $('#nextBus').value;
        const nextBus = nextVal === '' ? NaN : +nextVal;
        const out = $('#out');

        if (
          ![walkAll, toStop, headway, ride].every(Number.isFinite) ||
          walkAll <= 0 ||
          toStop < 0 ||
          headway <= 0 ||
          ride <= 0
        ) {
          out.innerHTML = `<h3>ê²°ê³¼</h3><div class="warn pill">ì…ë ¥ì„ í™•ì¸í•˜ì„¸ìš”. (ë„ë³´/ë°°ì°¨/íƒ‘ìŠ¹ ì‹œê°„ì€ 0ë³´ë‹¤ ì»¤ì•¼ í•©ë‹ˆë‹¤.)</div>`;
          return;
        }
        if (nextVal !== '' && (!Number.isFinite(nextBus) || nextBus < 0)) {
          out.innerHTML = `<h3>ê²°ê³¼</h3><div class="warn pill">ë‹¤ìŒ ë²„ìŠ¤ê¹Œì§€ ë‚¨ì€ ì‹œê°„ì€ 0 ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.</div>`;
          return;
        }

        const wait = waitTime(toStop, headway, nextBus);
        const etaBus = toStop + wait + ride;
        const etaWalk = walkAll;
        const diff = Math.abs(etaBus - etaWalk);

        let verdict;
        if (etaBus < etaWalk)
          verdict = `<span class="ok pill">ğŸšŒ ë²„ìŠ¤ê°€ ë” ë¹¨ë¼ìš” Â· ${fmt(
            diff
          )}ë¶„ ì´ë“</span>`;
        else if (etaBus > etaWalk)
          verdict = `<span class="warn pill">ğŸš¶ ê±·ëŠ” ê²Œ ë” ë¹¨ë¼ìš” Â· ${fmt(
            diff
          )}ë¶„ ì´ë“</span>`;
        else verdict = `<span class="pill">ğŸ¤ ë‘˜ì´ ê±°ì˜ ë¹„ìŠ·í•´ìš”</span>`;

        out.innerHTML = `
        <h3>ê²°ê³¼</h3>
        <div class="kv">
          <div>ë²„ìŠ¤ ETA</div><div>${fmt(etaBus)} ë¶„ (ëŒ€ê¸° ${fmt(
          wait
        )}ë¶„ í¬í•¨)</div>
          <div>ë„ë³´ ETA</div><div>${fmt(etaWalk)} ë¶„</div>
          <div>ì¶”ì²œ</div><div>${verdict}</div>
        </div>
      `;
      }

      function reset() {
        ['#walkAll', '#toStop', '#headway', '#ride', '#nextBus'].forEach(
          (sel) => {
            const el = $(sel);
            if (el) el.value = '';
          }
        );
        $(
          '#out'
        ).innerHTML = `<h3>ê²°ê³¼</h3><div class=muted style="font-size:13px">ê°’ì„ ì…ë ¥í•˜ê³  <b>ê³„ì‚°í•˜ê¸°</b>ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.</div>`;
      }

      // Events
      $('#calc').addEventListener('click', calc);
      $('#reset').addEventListener('click', reset);
      $('#fill').addEventListener('click', () => {
        const sample = {
          '#walkAll': 22,
          '#toStop': 5,
          '#headway': 10,
          '#ride': 12,
          '#nextBus': 3,
        };
        Object.entries(sample).forEach(([sel, val]) => {
          const t = document.querySelector(sel);
          if (t) t.value = val;
        });
      });
      ['#walkAll', '#toStop', '#headway', '#ride', '#nextBus'].forEach(
        (sel) => {
          const el = $(sel);
          el.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') calc();
          });
        }
      );
    </script>
  </body>
</html>
